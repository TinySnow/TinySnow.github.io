# 存储器构成

## 复习

7. 设计完成了加法器，可以处理三个输入（两个加数和一个进位），并可以串联构成多位加法器
8. 掌握了原码、反码和补码的概念，理解了补码可以统一加减法运算
9. 设计完成了减法器、乘法器和除法器，它们都基于加法器和移位操作
10. 理解了算术逻辑单元（ALU）如何集成各种运算功能
11. 掌握了锁存器和触发器的基本原理，了解它们如何存储一位二进制数据

## TL;DR

- 存储器由大量存储单元（如触发器）组成
- 存储器通过地址线选择要访问的存储单元
- 存储器分为随机访问存储器（RAM）和只读存储器（ROM）
- 不同类型的存储器在速度、容量和成本上各有优势

## 正文

### 从触发器到存储单元

　　我们已经知道，触发器可以存储一位二进制数据。那么，如何构建更大容量的存储器呢？

#### 基本存储单元

1. **位（Bit）存储**：
   - 一个触发器存储一位
   - 通常使用D触发器
   - 需要写使能信号控制

2. **字节（Byte）存储**：
   - 8个触发器组成一个字节
   - 共用时钟和写使能信号
   - 可以同时读写8位数据

### 存储器的基本结构

#### 1. 地址译码

　　存储器需要能够选择要访问的存储单元：

1. **地址线**：
   - 用于指定要访问的位置
   - n条地址线可以选择2ⁿ个位置

2. **译码器**：
   - 将地址转换为选择信号
   - 只激活一个存储单元

#### 2. 数据存取

1. **数据线**：
   - 读取时传输数据到输出
   - 写入时接收输入数据

2. **控制信号**：
   - 读/写控制
   - 片选信号
   - 时钟信号

### 存储器类型

#### 1. RAM（随机访问存储器）

　　可以随机读写的存储器：

1. **SRAM（静态RAM）**：
   - 用触发器存储数据
   - 只要通电就保持数据
   - 速度快但成本高
   - 常用于CPU缓存

2. **DRAM（动态RAM）**：
   - 用电容存储数据
   - 需要定期刷新
   - 密度高，成本低
   - 常用于主内存

#### 2. ROM（只读存储器）

　　内容固定的存储器：

1. **掩膜ROM**：
   - 出厂时写入数据
   - 永久不可改写
   - 用于存储固定程序

2. **PROM/EPROM/EEPROM**：
   - 可以重新编程
   - 写入速度慢
   - 常用于存储BIOS等

### 存储器的组织方式

#### 1. 位扩展

　　增加数据位宽：

```
8位扩展到16位：
[8位存储器] + [8位存储器]
共用地址线和控制信号
分别处理高8位和低8位
```

#### 2. 字扩展

　　增加存储容量：

```
1K扩展到2K：
[1K存储器]
[1K存储器]
用地址最高位选择
```

### 存储器的时序

#### 1. 同步存储器

　　由时钟信号控制：

1. **写操作**：
   - 在时钟上升沿写入数据
   - 需要满足建立时间和保持时间

2. **读操作**：
   - 在时钟上升沿输出数据
   - 有一定的访问延迟

#### 2. 异步存储器

　　由控制信号控制：

1. **写操作**：
   - 写使能有效时写入
   - 需要满足最小脉冲宽度

2. **读操作**：
   - 片选有效时即可读出
   - 有一定的访问延迟

### 存储器的性能指标

1. **容量**：
   - 可存储的总位数
   - 通常以字节为单位

2. **速度**：
   - 访问时间
   - 周期时间
   - 带宽

3. **功耗**：
   - 工作功耗
   - 待机功耗
   - 刷新功耗（DRAM）

### 实际应用举例

　　以一个简单的 4×8 位 RAM 为例：

```
容量：4个字节（4×8位）
地址线：2根（可选择4个位置）
数据线：8根（每次传输一个字节）
控制线：读/写、片选

写入数据：
1. 设置地址（如 10）
2. 准备数据（8位）
3. 写使能有效
4. 等待写入完成

读取数据：
1. 设置地址（如 10）
2. 读使能有效
3. 等待数据有效
4. 获取输出数据
```

**思考题 1**

> 　　为什么 CPU 中要使用多级缓存？

**思考题 2**

> 　　DRAM 为什么需要刷新？刷新会带来什么问题？

## 小结

### 知识点

- 存储器的基本构成
- RAM和ROM的特点
- 存储器的组织方式
- 同步和异步访问
- 存储器的性能指标

### 思考题答案（仅供参考）

#### 思考题 1

　　CPU使用多级缓存的原因：
1. 主内存访问速度远低于CPU速度
2. 不同级别缓存在速度和容量上做权衡
3. 局部性原理使得缓存很有效
4. 成本考虑，快速缓存造价高
5. 多级缓存可以优化访问模式

#### 思考题 2

　　DRAM刷新问题：
1. DRAM用电容存储，电荷会泄漏
2. 需要定期读出并重写数据（刷新）
3. 刷新会占用访问带宽
4. 刷新会增加功耗
5. 刷新会导致访问延迟

## 参考资料

1. [Wikipedia(zh)：随机存取存储器](https://zh.wikipedia.org/wiki/%E9%9A%8F%E6%9C%BA%E5%AD%98%E5%8F%96%E5%AD%98%E5%82%A8%E5%99%A8)：RAM的详细介绍
2. [Wikipedia(zh)：只读存储器](https://zh.wikipedia.org/wiki/%E5%94%AF%E8%AE%80%E8%A8%98%E6%86%B6%E9%AB%94)：ROM的基本概念

### 推荐

- [Bilibili：计算机内存是如何工作的](https://www.bilibili.com/video/BV1Zr4y1S7gG/)

## 协议

　　本作品采用[知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)进行许可。
