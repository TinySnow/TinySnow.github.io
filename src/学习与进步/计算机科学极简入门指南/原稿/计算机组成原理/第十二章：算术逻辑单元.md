# 算术逻辑单元

## 复习

1. 第七章：设计完成了加法器，可以处理三个输入（两个加数和一个进位），并可以串联构成多位加法器
2. 第八章：掌握了原码、反码和补码的概念，理解了补码可以统一加减法运算
3. 第九章：设计完成了减法器，本质是加上一个负数（补码）
4. 第十章：设计完成了乘法器，本质是移位和加法的组合
5. 第十一章：设计完成了除法器，本质是移位和减法的组合

## TL;DR

- 算术逻辑单元（ALU）是计算机的核心部件，负责执行所有的算术和逻辑运算
- ALU 由多个功能模块组成，通过控制信号选择不同的运算路径
- 理解 ALU 的工作原理，就是理解计算机如何进行运算

## 正文

### 引言

　　回想一下，现在有了什么：加法，减法，乘法，除法。可以做一些基础的运算了。除此之外，还有一些逻辑操作：与，或，非，异或，移位等等。

　　**注意，花十秒钟想一下，上面那些东西是怎么来的。如果不能清楚明白地了解其组成和原理，说明还没有学懂，建议回头再看一次。** 这里简单提示一下：

1. 晶体管组成逻辑门（与，或，非，异或等）；
2. 部分逻辑门的计算逻辑与加法一致，所以组成加法器；
3. 分出一位作为符号，在逻辑上弥补二进制减法的问题，使用 *模* 诱骗加法器在形式上做减法，形成减法器；
4. 用加法器和减法器，组成乘法器和除法器，如果愿意，其中可以有移位器。

　　利用上面的模块，一个简单的 ALU（Arithmetic Logic Unit，算术逻辑单元）就产生了。

### ALU 的基本结构

#### 输入部分

1. **数据输入**：
   - A 输入：第一个操作数
   - B 输入：第二个操作数
   - 每个输入都是多位二进制数

2. **控制输入**：
   - 操作码：决定执行什么运算
   - 状态输入：如进位输入等

#### 运算部分

1. **算术运算模块**：
   - 加法器：完成加法运算
   - 减法器：通过补码和加法器实现
   - 乘法器：通过移位和加法实现
   - 除法器：通过移位和减法实现

2. **逻辑运算模块**：
   - 与运算：按位进行与运算
   - 或运算：按位进行或运算
   - 非运算：按位取反
   - 异或运算：按位异或

3. **移位模块**：
   - 左移：用于乘法
   - 右移：用于除法
   - 循环移位：用于特殊运算

#### 输出部分

1. **数据输出**：
   - 运算结果：多位二进制数

2. **状态输出**：
   - 零标志（Z）：结果是否为零
   - 符号标志（S）：结果是否为负
   - 进位标志（C）：是否产生进位
   - 溢出标志（V）：是否发生溢出

### ALU 的工作原理

#### 基本工作流程

1. **准备阶段**：
   - 将操作数送入 A、B 输入端
   - 设置操作码，选择运算类型
   - 复位所有状态标志

2. **运算阶段**：
   - 根据操作码激活相应的运算模块
   - 数据通过选中的运算模块进行处理
   - 生成运算结果

3. **完成阶段**：
   - 输出运算结果
   - 设置相应的状态标志
   - 等待下一次运算

#### 实例：加法运算

　　以 5 + 3 为例，看看 ALU 是如何工作的：

1. **准备阶段**：
```
   A 输入：0101（5）
   B 输入：0011（3）
   操作码：0000（加法）
```

2. **运算阶段**：
   - 激活加法器模块
   - 按位相加：
```
     0101
     0011
     ————
     1000
```

3. **完成阶段**：
```
   结果：1000（8）
   零标志（Z）：0（非零）
   符号标志（S）：0（正数）
   进位标志（C）：0（无进位）
   溢出标志（V）：0（未溢出）
```

### 控制信号系统

#### 操作码的设计

| 操作码 | 功能 | 说明 |
|:-----:|:----:|:---:|
| 0000  | 加法 | A + B |
| 0001  | 减法 | A - B |
| 0010  | 与运算 | A AND B |
| 0011  | 或运算 | A OR B |
| 0100  | 非运算 | NOT A |
| 0101  | 异或 | A XOR B |
| 0110  | 左移 | A << 1 |
| 0111  | 右移 | A >> 1 |

#### 状态标志的含义

1. **零标志（Z）**：
   - Z = 1：结果为零
   - Z = 0：结果非零
   - 用于条件判断

2. **符号标志（S）**：
   - S = 1：结果为负
   - S = 0：结果为正
   - 用于有符号运算

3. **进位标志（C）**：
   - C = 1：产生进位
   - C = 0：无进位
   - 用于无符号运算

4. **溢出标志（V）**：
   - V = 1：发生溢出
   - V = 0：未溢出
   - 用于有符号运算

### ALU 的实际应用

1. **基本运算**：
   - 整数的加减乘除
   - 逻辑运算和移位
   - 比较和测试

2. **复杂运算**：
   - 浮点数运算（需要专门的浮点运算单元）
   - 向量运算
   - 特殊指令的支持

3. **性能优化**：
   - 流水线技术
   - 并行运算
   - 预测执行

### ALU 的意义

1. **统一管理**：
   - 集中管理所有运算功能
   - 简化控制逻辑
   - 提高资源利用率

2. **标准化接口**：
   - 统一的数据格式
   - 统一的控制方式
   - 便于系统集成

3. **性能保证**：
   - 优化的电路设计
   - 可靠的运算结果
   - 高效的资源调度

## 参考资料

1. [Wikipedia(zh)：算术逻辑单元](https://zh.wikipedia.org/wiki/%E7%AE%97%E8%A1%93%E9%82%8F%E8%BC%AF%E5%96%AE%E5%85%83)：ALU 的详细介绍
2. [Wikipedia(zh)：浮点运算单元](https://zh.wikipedia.org/wiki/%E6%B5%AE%E7%82%B9%E8%BF%90%E7%AE%97%E5%8D%95%E5%85%83)：FPU 的基本概念

### 推荐

- [Bilibili：计算机是如何做运算的](https://www.bilibili.com/video/BV1Zr4y1S7gG/)

## 协议

　　本作品采用[知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)进行许可。

## 封面图

![](https://raw.githubusercontent.com/TinySnow/GithubImageHosting/main/blog/computer-science-guide/cover/算术逻辑单元.png)

> 设计师 | 南国微雪